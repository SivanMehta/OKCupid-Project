## 1. Import the dataset and get the subset for people 21 or under.

```{r, cache = T}
profiles <- read.csv("profiles.csv")

# get rid of degree of caring
# from:
# http://stackoverflow.com/questions/7748149/apply-strsplit-to-specific-column-in-a-data-frame
profiles$sign <- sub("\\ .+$", "", profiles$sign)

wanted_profiles <- subset(profiles, age <= 30)
```


## 2. Sentiment Analysis

```{r, warning=FALSE, message = FALSE, fig.width = 12}
library(qdap)
library(plotly)

# take random sample because it takes ~5 minutes to analyze the polarity
# of a dataset this size
sample <- wanted_profiles[sample(nrow(wanted_profiles), 1000), ]
sample$polarity <- polarity(sample$essay0)$all$polarity

ggplot(subset(sample, income < 250000)) +
    geom_point(aes(x = age, y = income, colour = polarity)) + 
    scale_colour_gradientn(colours=c("#FF0000", "#ffffff", "#440088","#0000FF")) + 
    ggtitle("Income vs. Age, colored by Sentiment")

ggplotly()
```

This seems to suggest that polarity increases according to age because there are more blue points on the right side of the graph, this can be **very** loosely corroborated by the following scatter plot of polarity vs. age. As you can see by the coloring, there is no real correlation between sign and either of these variables.

```{r, fig.width = 12, warning=FALSE}

correlation <- cor(sample$income, sample$polarity, use = "na.or.complete") ** 2

mytext <- paste("Age vs. Income with", "r^2 = ", correlation, ", colored by polarity")

ggplot(subset(sample, income < 250000 & income > 0)) + 
    aes(x = income, y = age) + 
    geom_point(aes(colour = polarity)) + 
    scale_colour_gradientn(colours=c("#FF0000", "#ffffff", "#440088","#0000FF")) + 
    geom_smooth(method = "lm") + 
    ggtitle(mytext)
```

